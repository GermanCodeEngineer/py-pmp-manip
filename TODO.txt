TODOs:
    - move the fetching of input ids and types into opcode_info
    - complete optimization
